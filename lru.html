<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>lru算法</title>


    <style>



    </style>
</head>
<body>
     <div id="container">
         <p>请输入访存序列</p>
         <input type="text" id="number"/>
         <p>请输入分配的物理块数</p>
         <input type="text" id="line"/>
         <button id="getVal">获取值</button><button id="btn">运行</button>
         <div id="content">

         </div>

     </div>
</body>
<script>
    var oBtn = document.getElementById('btn');
    var ogetVal = document.getElementById('getVal');
    var oNumber = document.getElementById("number");
    var oLine = document.getElementById('line');
    var aQueue = [];
    var line = null;
    var aPage = [];
    var queueIdx = 0;
    var pageIdx = 0;
    var time = [];
    ogetVal.onclick = function(){
        line = oLine.value;
        var stringProcess = oNumber.value;
        aQueue = stringProcess.split(",");
    };
    oBtn.onclick = function(){

        if(pageIdx >= line){
            for(var i=0;i<aPage.length;i++){
                if(aPage[i] == aQueue[queueIdx]) {
                    aPage[i] = aQueue[queueIdx];
                    time[i] = 0;
                    break;
                }

            }
//            timer = setInterval(function() {
//                if(i != length) {
//                    flog = 0;
//                    stackStatus.html(length - i - 1);
//                    loseStatus.html(parseInt(((i - flogTime + 1) / stack.length)* 100) + '%');
//                    if((length - i - 1) == 0)

            if( i == aPage.length){
                var iMax = 0;
                for(i = 0;i<time.length;i++){
                    if(time[iMax] < time[i]){
                        iMax = i;
                    }
                }
                console.log("索引pageIdx :"+iMax+"满足最近最久，可以置换");
                aPage[iMax] = aQueue[queueIdx];
                time[iMax] = 0;
            }

        }else{
            for(i=0;i<aPage.length;i++){
                if(aPage[i] == aQueue[queueIdx]){
                    aPage[i] = aQueue[queueIdx];
                    time[i] = 0;
                    break;
                }

            }
            if(i == aPage.length){
                aPage[pageIdx] = aQueue[queueIdx];
                time[pageIdx] = 0;
            }
        }
        for(i = 0;i<aPage.length;i++){
            time[i] = time[i] + 1;
        }
            pageIdx++;
            queueIdx++;
        console.log("页面内容:"+aPage);
        console.log("元素存在时间:"+time);

        if(queueIdx == aQueue.length){
            alert("完成");
            oBtn.onclick = null;
        }


    }


</script>
</html>